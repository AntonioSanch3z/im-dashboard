<div class="mt-2">
    <div id="{{key}}-container"></div>
    <button type="button" class="btn btn-sm btn-outline-info" id="add-new-item-{{key}}" class="add-new" data-tag-name="{{key}}">Add</button>
    <input id="id-{{key}}" type="hidden" data-output-type="json" name="{{key}}" value=""/>
</div>

<script lang="javascript">

let num__{{key}} = 1;

function addItem_{{key}}(object=null, value='') {
  var tagname = object.getAttribute('data-tag-name');
  {% if value.entry_schema.type in ["PortSpec", "tosca.datatypes.network.PortSpec"] %}
  var pattern = "(([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))){0,1}-{0,1}([0-9]+:{0,1}[0-9]+)";
  {% elif value.entry_schema.type == "integer" %}
  var pattern = "[0-9]+";
  {% elif value.entry_schema.type == "float" %}
  var pattern = "[0-9]+\.{0,1}[0-9]+";
  {% elif value.entry_schema.type == "boolean" %}
  var pattern = "true|false";
  {% else %}
  var pattern = ".*";
  {% endif %}
  let template = `
      <div class="form-row" id="${tagname}-${num__{{key}}}">

        <div class="form-group">
          <!-- label>Option</label> <br-->
          <input type="text" class="form-control" name="${tagname}_list_value_${num__{{key}}}" class="form-control" required pattern="${pattern}" value="${value}">
        </div>
        <div class="mt-1 mx-2">
          <button type=button class='btn btn-sm btn-outline-danger' href="" onclick="javascript:removeItem('${tagname}'+ '-' + ${num__{{key}}} + '' ); return false;">Remove</button>
        </div>
      </div>`;

  let container = document.getElementById(tagname + '-container');
  let div = document.createElement('div');
  div.innerHTML = template;
  container.appendChild(div);

  num__{{key}}++;
}


document.getElementById('add-new-item-{{key}}').onclick = addItem_{{key}};

function removeItem(elementId) {
    var element = document.getElementById(elementId);
    element.parentNode.removeChild(element);
}

var add_item_btn = document.getElementById('add-new-item-{{key}}');

{% if value.entry_schema.type in ["PortSpec", "tosca.datatypes.network.PortSpec"] %}
  {% if input_value %}
    {% set ports = utils.formatPortSpec(input_value) %}
    {% for k, v in ports.items() %}
    addItem_{{key}}(add_item_btn, value='{{v}}')
    {% endfor %}
  {% endif %}
{% endif %}

</script>